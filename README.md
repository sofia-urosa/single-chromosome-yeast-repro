# single-chromosome-yeast-repro

Analytical reproducibility of the computational analyses supporting Shao et al. (2018), verifying transcriptomic stability and chromatin contact structure in the single-chromosome yeast strain.

## Software versions

The following software versions were used:

### Genome assembly and alignment
- Canu **v1.5**
- LAST **v1650**

### Short-read alignment and variant calling
- BWA-MEM **v0.7.17**
- samtools **v1.12**
- bcftools **v1.12**

### RNA-seq analysis
- Bowtie2 **v2.2.2**
- RSEM **v1.3.0**
- R **v3.4.1**
- DESeq2 **v1.16.1**

### Hi-C analysis
- hiclib-legacy (Mirny lab, legacy version)
- Bowtie2 **v2.5.1**
- Python **v3.6**

### Environment management
- Conda / Miniconda
- SLURM workload manager (HPC)

## Repository structure

- `scripts/`  
  Shell, SLURM, and R scripts used to run the analyses.

- `originals/`  
  Raw input data downloaded from public repositories (not tracked in Git).

- `outputs/`  
  Analysis outputs generated by the pipelines (not tracked in Git).

- `envs/`  
  Conda environment YAML files used to manage software dependencies.

- `notebooks/`  
  Supplementary notebooks for exploratory analysis and figure generation.


## How to run the pipeline

This guide assumes you're running the code from the project's root folder. You can run it from elsewhere, but as a safety measure 

⚠️ Before running any shell code make sure they are executable files (chmod +x)
### 1. Clone the repository
```bash
git clone https://github.com/sofia-urosa/single-chromosome-yeast-repro.git
cd single-chromosome-yeast-repro
```
### 2. Set up conda environments and tools
```bash
./scripts/setup.sh
```

### 3. Download data in originals/
Subdirectories are expected for:
- pacbio/
- wgs/
- rnaseq/
- hic/
  
Run:
```bash
./scripts/check_data.sh
```

For a summary of expected files.

### 4. Short read alignment / Long read Assembly 

For alignment:

```bash
sbatch ./scripts/align_assembly.slurm
```

For assembly:

```bash
sbatch ./scripts/assemble_by4742.slurm
sbatch ./scripts/assemble_sy14.slurm
```

⚠️ Assemblies take a lot of computing power. We recommend running one strain at a time to reduce the probability of reaching SLURM resource limits per user. 

### 5. RNA-seq

```bash
./scripts/rnaseq_pipeline.sh
./scripts/rsem_pipeline.slurm
```

Differential expression analysis:
This code uses DESeq2 v1.16.1, which needs a version of R unavailable at the time. Therefore we use a singularity:

```bash
singularity exec   --bind .:/mnt   tools/bioc_3_5.sif   Rscript /mnt/scripts/gene_counts.R   /mnt/outputs/rnaseq/quant   /mnt/outputs/rnaseq/expression_analysis
```

Figure reproduction:

Fig 4a (transcriptome heatmap and pearson correlation matrix)

```bash
Rscript ./scripts/fig4a_heatmap.R
```

Fig 4b (up and down regulated gene count from significantly expressed genes)

```bash
Rscript ./scripts/fig4b_stress_genes.R
```

### 6. HiC

```bash
./scripts/hic_pipeline.sh
```

## Purpose

This repository accompanies a coursework submission for **7BBG1002 Applied Bioinformatics and Cloud Computing** and is intended to demonstrate practical reproducibility challenges in computational genomics.

It is provided for transparency and educational purposes.

## References 
[1] Shao, Y., Lu, N., Wu, Z. et al. Creating a functional single-chromosome yeast. Nature 560, 331–335 (2018). https://doi.org/10.1038/s41586-018-0382-x
